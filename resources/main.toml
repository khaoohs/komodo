[[server]]
name = "dockarr(local)"
[server.config]
enabled = true

##

[[stack]]
name = "audiobookshelf"
[stack.config]
server = "dockarr(local)"
poll_for_updates = true
auto_update = true
auto_update_all_services = true
linked_repo = "gh-komodo"
run_directory = "stacks/dockarr/audiobookshelf"
environment = """
  # VARIABLE = value
TZ=America/New_York
"""

##

[[stack]]
name = "copyparty"
[stack.config]
server = "dockarr(local)"
poll_for_updates = true
auto_update = true
auto_update_all_services = true
linked_repo = "gh-komodo"
run_directory = "stacks/dockarr/copyparty"
environment = """
  # VARIABLE = value
TZ=America/New_York
"""

##

[[stack]]
name = "jellystack"
[stack.config]
server = "dockarr(local)"
poll_for_updates = true
auto_update = true
auto_update_all_services = true
linked_repo = "gh-komodo"
run_directory = "stacks/dockarr/jellystack"
environment = """
  # VARIABLE = value
TZ=America/New_York
JFVER=10.11.6
"""

##

[[stack]]
name = "mealie"
[stack.config]
server = "dockarr(local)"
poll_for_updates = true
auto_update = true
auto_update_all_services = true
linked_repo = "gh-komodo"
run_directory = "stacks/dockarr/mealie"
environment = """
  # VARIABLE = value
TZ=America/New_York
"""

##

[[stack]]
name = "repo-stack"
template = true
[stack.config]
poll_for_updates = true
auto_update = true
auto_update_all_services = true
linked_repo = "gh-komodo"
run_directory = "stacks/dockarr"
environment = """
  # VARIABLE = value
TZ=America/New_York
"""

##

[[stack]]
name = "tubearchivist"
[stack.config]
server = "dockarr(local)"
linked_repo = "gh-komodo"
run_directory = "stacks/dockarr/tubearchivist"

##

[[repo]]
name = "gh-komodo"
[repo.config]
server = "dockarr(local)"
git_account = "khaoohs"
repo = "khaoohs/komodo"

##

[[procedure]]
name = "Global Auto Update"
description = "Pulls and auto updates Stacks and Deployments using 'poll_for_updates' or 'auto_update'."
tags = ["system"]
config.schedule = "Every day at 03:00"

[[procedure.config.stage]]
name = "Stage 1"
enabled = true
executions = [
  { execution.type = "GlobalAutoUpdate", execution.params = {}, enabled = true }
]

##

[[builder]]
name = "Local"
[builder.config]
type = "Server"
params.server_id = "dockarr(local)"

##

[[resource_sync]]
name = "komodo-main"
description = "Sync Komodo config to github."
[resource_sync.config]
linked_repo = "gh-komodo"
resource_path = ["resources/main.toml"]
managed = true